(function(f){f.fn.wallyti=function(m){var l={blockMaxWidth:360,blockMinWidth:240,blockMargin:35,delayOnResize:60,disableTransitions:!1,cssTransition:"all 0.2s ease-in-out",onComplete:function(){}},a={},a="object"!=typeof m?l:f.extend(l,m);return this.each(function(){function m(){setTimeout(function(){w==f(document).height()>f(window).height()&&n==b.outerWidth()||b.wallyti(a)},100);a.onComplete()}function l(){v||(v=0==--x)&&m()}var p,k,q,e,r,t=1,h=[],g=[],d=[],b=f(this),d=b.children();if(e=d.length){var x=
e,v=!1,u="all 0s ease 0s"!=d.css("transition")&&""!=d.css("transition")&&0!=d.css("transition").length;b.addClass("wallyti-container").css({"-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box","box-sizing":"border-box",position:"relative",padding:"0"});d.addClass("wallyti-block").css({"-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box","box-sizing":"border-box",position:"absolute",visibility:"hidden"});if(a.cssTransition&&40>=e&&!a.disableTransitions)d.css({"-webkit-transition":a.cssTransition,
"-moz-transition":a.cssTransition,"-o-transition":a.cssTransition,transition:a.cssTransition}),u=!0;else if(40<e||a.disableTransitions)d.css({"-webkit-transition":"none","-moz-transition":"none","-o-transition":"none",transition:"none"}),u=a.jsTransition=!1;var n=b.outerWidth(),w=f(document).height()>f(window).height();e=b.attr("wallyti-block-max")?parseInt(b.attr("wallyti-block-max")):a.blockMaxWidth;r=b.attr("wallyti-block-min")?parseInt(b.attr("wallyti-block-min")):a.blockMinWidth;q=b.attr("wallyti-block-margin")?
parseInt(b.attr("wallyti-block-margin")):d.css("margin-right")?parseInt(d.css("margin-right")):a.blockMargin;for(c=Math.floor(n/r)+2;0<c;c--)if(p=Math.floor(n/c+q/c),k=p-q,k<r?g[c]="narrow":k>e&&(g[c]="wide"),"narrow"==g[c+1]&&"wide"==g[c]){g[t=c]="ok";break}else if(k>=r&&k<=e){g[t=c]="ok";break}for(c=0;c<t;c++)h[c]=0;d.each(function(){var a=f(this),d,e=1<t?h.indexOf(Math.min.apply(Math,h)):0,g={top:h[e],left:0<=e*p?e*p:0,width:k};cloned=a.clone();cloned.css(g).css("visibility","hidden").addClass("cloned").appendTo(b);
d=cloned.outerHeight();h[e]+=d+q;cloned.remove();if(u)a.addClass("wallyti-moving").off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend").on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(b){a.removeClass("wallyti-moving");l()});a.css("visibility","visible");a.css(g);u&&"1"==parseInt(b.data("wallyti-executed"))||l()});b.height(Math.max.apply(Math,h));b.data("wallyti-executed","1");f(window).off("resize.wallyti").on("resize.wallyti",
function(){clearTimeout(window.resizedFinished);window.resizedFinished=setTimeout(function(){n!=b.outerWidth()&&b.wallyti(a)},a.delayOnResize)})}})}})(jQuery);